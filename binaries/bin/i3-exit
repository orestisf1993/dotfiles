#!/bin/bash
# rofi-power
# Use rofi to call systemctl for shutdown, reboot, etc
# Taken from https://github.com/okraits/rofi-tools/blob/822d21d99104fba14f1eaee61f4258905ab91250/rofi-power
# 2016 Oliver Kraitschy - http://okraits.de
set -e

declare -A options
declare -a options_order

function add_option() {
    options["$1"]="$2"
    options_order+=("$1")
}

# Fill options.
if [ -f "$HOME/.screenlayout/toggle-radeon.sh" ]
then
    add_option "Toggle screens" "$HOME/.screenlayout/toggle-radeon.sh"
fi
add_option "Sleep monitor" "xset dpms force suspend"
add_option "Lock" "$HOME/bin/lock.sh"
add_option "Exit" "i3-msg exit"
add_option "Suspend system" "systemctl suspend"
add_option "Reboot system" "systemctl reboot"
add_option "Power-off system" "systemctl poweroff"
# add_option "Hibernate" "systemctl hibernate"
options_keys=$(printf '%s\n' "${options_order[@]}")  # Get keys as a string, seperated by newlines.
options_len=$(echo -e "$options_keys"|wc -l)
echo -e "$options_keys"

launcher="rofi -matching fuzzy -width 10 -hide-scrollbar -l $options_len -dmenu -i -p rofi-power:"
selection=$(echo -e "$options_keys" | $launcher | tr -d '\r\n')
echo "$selection : ${options[$selection]}"

eval "${options[$selection]}"
